<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Buscador de Manzanas por Colonia | CDMX</title>

<!-- Select2 -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

<style>
body {
    font-family: Arial, sans-serif;
    margin: 40px;
    background: #f7f7f7;
}
.container {
    background: white;
    padding: 25px;
    border-radius: 8px;
    max-width: 750px;
    margin: auto;
    box-shadow: 0 2px 10px rgba(0,0,0,0.15);
}
h2 {
    margin-bottom: 20px;
    color: #333;
}
.resultado {
    margin-top: 25px;
    padding: 20px;
    border-radius: 6px;
    background: #e7f3ff;
    font-size: 18px;
    border-left: 5px solid #007acc;
}
</style>
</head>
<body>

<div class="container">

<h2>Buscador de Número de Manzanas por Colonia</h2>

<label>Buscar colonia o alcaldía:</label>
<select id="selector" style="width: 100%"></select>

<div id="resultado" class="resultado" style="display:none;"></div>

</div>

<!-- JS -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<script>
let datos = [];

// Cargar el CSV directamente desde el repositorio
fetch('manzanas_por_colonia.csv')
  .then(resp => resp.text())
  .then(texto => {
    let lineas = texto.split("\n").map(l => l.trim()).filter(l => l.length > 0);
    let headers = lineas[0].split(",");

    // Convertir CSV a objetos JSON
    datos = lineas.slice(1).map(l => {
      let cols = l.split(",");
      return {
        MUN_NAME: cols[0],
        SETT_NAME: cols[1],
        SETT_TYPE: cols[2],
        CP: cols[3],
        MANZANAS: cols[4]
      };
    });

    // Poblar el selector
    let opciones = datos.map((d,i) => ({
        id: i,
        text: `${d.SETT_NAME} (${d.MUN_NAME})`
    }));

    $('#selector').select2({
        data: opciones,
        placeholder: "Escribe el nombre de la colonia o alcaldía…",
        allowClear: true
    });
  });

// Mostrar información al seleccionar
$('#selector').on('change', function() {
    let idx = $(this).val();
    if (idx === null) return;

    let d = datos[idx];

    document.getElementById("resultado").style.display = "block";
    document.getElementById("resultado").innerHTML =
        `<b>Alcaldía:</b> ${d.MUN_NAME}<br>
         <b>Colonia:</b> ${d.SETT_NAME}<br>
         <b>Tipo:</b> ${d.SETT_TYPE}<br>
         <b>Código Postal:</b> ${d.CP}<br><br>
         <h3>Número de manzanas: <span style='color:#d9534f'>${d.MANZANAS}</span></h3>`;
});
</script>

</body>
</html>
